"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunk_N_E"] = self["webpackChunk_N_E"] || []).push([["node_modules_pnpm_censo-custody_solana-wallet-adapter_0_1_0_bufferutil_4_0_9_encoding_0_1_13_-fbb96f"],{

/***/ "../node_modules/.pnpm/@censo-custody+solana-wallet-adapter@0.1.0_bufferutil@4.0.9_encoding@0.1.13_utf-8-validate@5.0.10/node_modules/@censo-custody/solana-wallet-adapter/lib/esm/censocustody.js":
/*!*********************************************************************************************************************************************************************************************************!*\
  !*** ../node_modules/.pnpm/@censo-custody+solana-wallet-adapter@0.1.0_bufferutil@4.0.9_encoding@0.1.13_utf-8-validate@5.0.10/node_modules/@censo-custody/solana-wallet-adapter/lib/esm/censocustody.js ***!
  \*********************************************************************************************************************************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   CensoWallet: function() { return /* binding */ CensoWallet; }\n/* harmony export */ });\n/* harmony import */ var _solana_web3_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @solana/web3.js */ \"../node_modules/.pnpm/@solana+web3.js@1.98.0_bufferutil@4.0.9_encoding@0.1.13_utf-8-validate@5.0.10/node_modules/@solana/web3.js/lib/index.browser.esm.js\");\n/* harmony import */ var bs58__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! bs58 */ \"../node_modules/.pnpm/bs58@4.0.1/node_modules/bs58/index.js\");\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! uuid */ \"../node_modules/.pnpm/uuid@8.3.2/node_modules/uuid/dist/esm-browser/index.js\");\n/* harmony import */ var eventemitter3__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! eventemitter3 */ \"../node_modules/.pnpm/eventemitter3@4.0.7/node_modules/eventemitter3/index.js\");\n/* provided dependency */ var Buffer = __webpack_require__(/*! buffer */ \"../node_modules/.pnpm/buffer@6.0.3/node_modules/buffer/index.js\")[\"Buffer\"];\n\n\n\n\nconst DEFAULT_SIGNATURE_BUFFER = Buffer.alloc(_solana_web3_js__WEBPACK_IMPORTED_MODULE_0__.SIGNATURE_LENGTH_IN_BYTES).fill(0);\nclass CensoWallet extends eventemitter3__WEBPACK_IMPORTED_MODULE_2__.EventEmitter {\n    constructor() {\n        super();\n        this.url = 'https://wallet.censocustody.com';\n        this.cleanUp = () => {\n            [...this._timers].forEach(t => this.clearTimer(t));\n            const wallet = this._wallet;\n            if (wallet) {\n                wallet.close();\n            }\n            this._wallet = null;\n            this.emit('disconnected');\n        };\n        this.clearTimer = (timer) => {\n            this._timers = this._timers.filter(t => t != timer);\n            window.clearInterval(timer);\n        };\n        this.instructionsToSerializableInstructions = (instructions) => instructions.map(i => {\n            return {\n                'programId': i.programId.toBase58(),\n                'accountMetas': i.keys.map(k => {\n                    return {\n                        address: k.pubkey.toBase58(),\n                        signer: k.isSigner,\n                        writable: k.isWritable,\n                    };\n                }),\n                'data': window.btoa(String.fromCharCode(...i.data)),\n            };\n        });\n        this.handleWalletMessage = (data) => {\n            var _a, _b, _c;\n            if (data.type == \"connected\") {\n                this._connecting = false;\n                if (!data.error) {\n                    this.isLoggedIn = true;\n                    if ((_a = data.connected) === null || _a === void 0 ? void 0 : _a.publicKey) {\n                        this._publicKey = new _solana_web3_js__WEBPACK_IMPORTED_MODULE_0__.PublicKey(data.connected.publicKey);\n                    }\n                }\n            }\n            else if ([\"sendTransaction\", \"sendFinalTransaction\"].includes(data.type)) {\n                const transactionIdentifier = (_b = data.sendTransaction) === null || _b === void 0 ? void 0 : _b.identifier;\n                if (transactionIdentifier && transactionIdentifier in this._pendingTransactions) {\n                    if (data.error) {\n                        this._pendingTransactionErrors[transactionIdentifier] = { message: data.error };\n                    }\n                    else {\n                        this._pendingTransactions[transactionIdentifier] = data.sendTransaction || null;\n                    }\n                }\n            }\n            else if (data.type == \"signTransaction\") {\n                const transactionIdentifier = (_c = data.signTransaction) === null || _c === void 0 ? void 0 : _c.identifier;\n                if (transactionIdentifier && transactionIdentifier in this._pendingTransactions) {\n                    if (data.error) {\n                        this._pendingTransactionErrors[transactionIdentifier] = { message: data.error };\n                    }\n                    else {\n                        this._pendingTransactions[transactionIdentifier] = data.signTransaction || null;\n                    }\n                }\n            }\n        };\n        this.isLoggedIn = false;\n        this._pendingTransactions = {};\n        this._pendingTransactionErrors = {};\n        this._timers = [];\n        this._wallet = null;\n        this._connecting = false;\n        this._publicKey = null;\n        window.addEventListener(\"message\", (e) => {\n            this.handleWalletMessage(e.data);\n        });\n    }\n    async connect(url) {\n        try {\n            this.url = url || this.url;\n            const origin = encodeURIComponent(window.location.origin);\n            const connectUrl = `${this.url}/connect?origin=${origin}`;\n            this._connecting = true;\n            this._wallet = window.open(connectUrl, `censo-custody-${origin}`, \"height=900,width=800,menubar=no,status=no,toolbar=no\");\n            if (!this._wallet) {\n                this._connecting = false;\n                throw new Error(\"Unable to connect to wallet\");\n            }\n            this._timers.push(window.setInterval(() => {\n                if (this._wallet.closed) {\n                    this.cleanUp();\n                }\n                else if (this._wallet) {\n                    this._wallet.postMessage({ type: 'heartbeat' }, this.url);\n                }\n            }, 100));\n            return new Promise((resolve, reject) => {\n                const timer = window.setInterval(() => {\n                    if (this.isLoggedIn && this._publicKey) {\n                        this.clearTimer(timer);\n                        resolve(this._publicKey);\n                    }\n                    else if (!this.isLoggedIn && !this._connecting) {\n                        this.clearTimer(timer);\n                        reject(new Error(\"Unable to connect to Censo\"));\n                    }\n                }, 100);\n                this._timers.push(timer);\n            });\n        }\n        catch (error) {\n            throw error;\n        }\n    }\n    async signTransaction(transaction) {\n        this.verifyCanSignRequests([transaction]);\n        try {\n            return this.signOneTransaction(transaction);\n        }\n        catch (error) {\n            throw error;\n        }\n    }\n    async signAllTransactions(transactions) {\n        this.verifyCanSignRequests(transactions);\n        try {\n            return this.signMultipleTransactions(transactions);\n        }\n        catch (error) {\n            throw error;\n        }\n    }\n    async sendTransaction(transaction, connection, options) {\n        try {\n            const wallet = this._wallet;\n            if (!wallet)\n                throw new Error(\"Not Connected\");\n            const transactionIdentifier = (0,uuid__WEBPACK_IMPORTED_MODULE_3__.v4)();\n            this._pendingTransactions[transactionIdentifier] = null;\n            const signers = options ? options.signers : undefined;\n            if (signers && signers.length > 0) {\n                return new Promise((resolve, reject) => {\n                    this.signOneTransaction(transaction, transactionIdentifier).then(walletTransaction => {\n                        this._pendingTransactions[transactionIdentifier] = null;\n                        (signers === null || signers === void 0 ? void 0 : signers.length) && walletTransaction.partialSign(...signers);\n                        wallet.postMessage({\n                            type: \"sendFinalTransaction\", sendFinalTransaction: {\n                                transactionIdentifier,\n                                signaturePubkeyPairs: walletTransaction.signatures.filter(sp => sp.signature != null).map(sp => {\n                                    return {\n                                        'pubkey': sp.publicKey.toBase58(),\n                                        'signature': sp.signature.toString('base64')\n                                    };\n                                })\n                            }\n                        }, this.url);\n                        const timer = window.setInterval(() => {\n                            const pendingTransaction = this._pendingTransactions[transactionIdentifier];\n                            const pendingTransactionError = this._pendingTransactionErrors[transactionIdentifier];\n                            if (pendingTransaction != null || pendingTransactionError != null) {\n                                this.clearTimer(timer);\n                                pendingTransaction && resolve(pendingTransaction.signature);\n                                pendingTransactionError && reject(pendingTransactionError);\n                            }\n                        }, 100);\n                        this._timers.push(timer);\n                    }).catch((error) => {\n                        reject(error);\n                        throw error;\n                    });\n                });\n            }\n            else {\n                const instructions = this.instructionsToSerializableInstructions(transaction.instructions);\n                return new Promise((resolve, reject) => {\n                    wallet.postMessage({\n                        type: \"sendTransaction\",\n                        sendTransaction: { instructions, transactionIdentifier }\n                    }, this.url);\n                    const timer = window.setInterval(() => {\n                        const pendingTransaction = this._pendingTransactions[transactionIdentifier];\n                        const pendingTransactionError = this._pendingTransactionErrors[transactionIdentifier];\n                        if (pendingTransaction != null || pendingTransactionError != null) {\n                            this.clearTimer(timer);\n                            pendingTransaction && resolve(pendingTransaction.signature);\n                            pendingTransactionError && reject(pendingTransactionError);\n                        }\n                    }, 100);\n                    this._timers.push(timer);\n                });\n            }\n        }\n        catch (error) {\n            throw error;\n        }\n    }\n    buildTransaction(pendingTransaction) {\n        let message = _solana_web3_js__WEBPACK_IMPORTED_MODULE_0__.Message.from(Buffer.from(Uint8Array.from(window.atob(pendingTransaction.message), c => c.charCodeAt(0))));\n        return _solana_web3_js__WEBPACK_IMPORTED_MODULE_0__.Transaction.populate(message, Array.from({ length: message.header.numRequiredSignatures }, (_v, i) => {\n            let sigPubkeyPair = pendingTransaction.signatures.find(s => s.pubkey == message.accountKeys[i].toBase58());\n            return bs58__WEBPACK_IMPORTED_MODULE_1__.encode(sigPubkeyPair\n                ? Buffer.from(Uint8Array.from(window.atob(sigPubkeyPair.signature), c => c.charCodeAt(0)))\n                : DEFAULT_SIGNATURE_BUFFER);\n        }));\n    }\n    verifyCanSignRequests(transactions) {\n        transactions.forEach(transaction => {\n            if (transaction.signatures.some(s => s.signature != null)) {\n                throw new Error(\"Censo does not support this signing mode\");\n            }\n        });\n    }\n    signOneTransaction(transaction, transactionIdentifier = (0,uuid__WEBPACK_IMPORTED_MODULE_3__.v4)()) {\n        const wallet = this._wallet;\n        if (!wallet)\n            throw new Error(\"Not Connected\");\n        const instructions = this.instructionsToSerializableInstructions(transaction.instructions);\n        this._pendingTransactions[transactionIdentifier] = null;\n        return new Promise((resolve, reject) => {\n            wallet.postMessage({ type: \"signTransaction\", signTransaction: { instructions, transactionIdentifier } }, this.url);\n            const timer = window.setInterval(() => {\n                const pendingTransaction = this._pendingTransactions[transactionIdentifier];\n                const pendingTransactionError = this._pendingTransactionErrors[transactionIdentifier];\n                if (pendingTransaction != null || pendingTransactionError != null) {\n                    this.clearTimer(timer);\n                    pendingTransaction && resolve(this.buildTransaction(pendingTransaction));\n                    pendingTransactionError && reject(pendingTransactionError);\n                }\n            }, 100);\n            this._timers.push(timer);\n        });\n    }\n    signMultipleTransactions(transactions) {\n        const wallet = this._wallet;\n        if (!wallet)\n            throw new Error(\"Not Connected\");\n        const serializedTransactions = transactions.map((t) => {\n            return {\n                instructions: this.instructionsToSerializableInstructions(t.instructions),\n                transactionIdentifier: (0,uuid__WEBPACK_IMPORTED_MODULE_3__.v4)()\n            };\n        });\n        const transactionIdentifiers = serializedTransactions.map((t) => t.transactionIdentifier);\n        transactionIdentifiers.forEach((transactionIdentifier) => this._pendingTransactions[transactionIdentifier] = null);\n        return new Promise((resolve, reject) => {\n            wallet.postMessage({ type: \"signAllTransactions\", signAllTransactions: { transactions: serializedTransactions } }, this.url);\n            const timer = window.setInterval(() => {\n                const pendingTransactions = transactionIdentifiers.map((txId) => this._pendingTransactions[txId]);\n                const pendingTransactionErrors = transactionIdentifiers.map((txId) => this._pendingTransactionErrors[txId]);\n                if (pendingTransactions.every((t) => t != null)) {\n                    this.clearTimer(timer);\n                    resolve(pendingTransactions.map((pt) => this.buildTransaction(pt)));\n                }\n                else if (pendingTransactionErrors.some((e) => e != null)) {\n                    this.clearTimer(timer);\n                    reject(pendingTransactionErrors.find((e) => e != null));\n                }\n            }, 100);\n            this._timers.push(timer);\n        });\n    }\n}\n//# sourceMappingURL=censocustody.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi4vbm9kZV9tb2R1bGVzLy5wbnBtL0BjZW5zby1jdXN0b2R5K3NvbGFuYS13YWxsZXQtYWRhcHRlckAwLjEuMF9idWZmZXJ1dGlsQDQuMC45X2VuY29kaW5nQDAuMS4xM191dGYtOC12YWxpZGF0ZUA1LjAuMTAvbm9kZV9tb2R1bGVzL0BjZW5zby1jdXN0b2R5L3NvbGFuYS13YWxsZXQtYWRhcHRlci9saWIvZXNtL2NlbnNvY3VzdG9keS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBNkY7QUFDckU7QUFDWTtBQUNTO0FBQzdDLGlDQUFpQyxNQUFNLE9BQU8sc0VBQXlCO0FBQ2hFLDBCQUEwQix1REFBWTtBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDLHNEQUFTO0FBQ3ZEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0ZBQWtGO0FBQ2xGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0ZBQWtGO0FBQ2xGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0MsU0FBUyxrQkFBa0IsT0FBTztBQUNwRTtBQUNBLG9FQUFvRSxPQUFPO0FBQzNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtDQUErQyxtQkFBbUI7QUFDbEU7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQ0FBMEMsd0NBQU07QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDO0FBQ2pDO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQixpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkNBQTJDO0FBQzNDLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLG9EQUFPLE1BQU0sTUFBTTtBQUN6QyxlQUFlLHdEQUFXLGdDQUFnQyw4Q0FBOEM7QUFDeEc7QUFDQSxtQkFBbUIsd0NBQVc7QUFDOUIsa0JBQWtCLE1BQU07QUFDeEI7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsNERBQTRELHdDQUFNO0FBQ2xFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQyw0Q0FBNEMsdUNBQXVDO0FBQ3BIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVDQUF1Qyx3Q0FBTTtBQUM3QztBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUMsb0RBQW9ELHdDQUF3QztBQUM3SDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL19OX0UvLi4vbm9kZV9tb2R1bGVzLy5wbnBtL0BjZW5zby1jdXN0b2R5K3NvbGFuYS13YWxsZXQtYWRhcHRlckAwLjEuMF9idWZmZXJ1dGlsQDQuMC45X2VuY29kaW5nQDAuMS4xM191dGYtOC12YWxpZGF0ZUA1LjAuMTAvbm9kZV9tb2R1bGVzL0BjZW5zby1jdXN0b2R5L3NvbGFuYS13YWxsZXQtYWRhcHRlci9saWIvZXNtL2NlbnNvY3VzdG9keS5qcz9jNTU2Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE1lc3NhZ2UsIFB1YmxpY0tleSwgU0lHTkFUVVJFX0xFTkdUSF9JTl9CWVRFUywgVHJhbnNhY3Rpb24gfSBmcm9tIFwiQHNvbGFuYS93ZWIzLmpzXCI7XG5pbXBvcnQgYnM1OCBmcm9tIFwiYnM1OFwiO1xuaW1wb3J0IHsgdjQgYXMgdXVpZHY0IH0gZnJvbSBcInV1aWRcIjtcbmltcG9ydCB7IEV2ZW50RW1pdHRlciB9IGZyb20gXCJldmVudGVtaXR0ZXIzXCI7XG5jb25zdCBERUZBVUxUX1NJR05BVFVSRV9CVUZGRVIgPSBCdWZmZXIuYWxsb2MoU0lHTkFUVVJFX0xFTkdUSF9JTl9CWVRFUykuZmlsbCgwKTtcbmV4cG9ydCBjbGFzcyBDZW5zb1dhbGxldCBleHRlbmRzIEV2ZW50RW1pdHRlciB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMudXJsID0gJ2h0dHBzOi8vd2FsbGV0LmNlbnNvY3VzdG9keS5jb20nO1xuICAgICAgICB0aGlzLmNsZWFuVXAgPSAoKSA9PiB7XG4gICAgICAgICAgICBbLi4udGhpcy5fdGltZXJzXS5mb3JFYWNoKHQgPT4gdGhpcy5jbGVhclRpbWVyKHQpKTtcbiAgICAgICAgICAgIGNvbnN0IHdhbGxldCA9IHRoaXMuX3dhbGxldDtcbiAgICAgICAgICAgIGlmICh3YWxsZXQpIHtcbiAgICAgICAgICAgICAgICB3YWxsZXQuY2xvc2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX3dhbGxldCA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLmVtaXQoJ2Rpc2Nvbm5lY3RlZCcpO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLmNsZWFyVGltZXIgPSAodGltZXIpID0+IHtcbiAgICAgICAgICAgIHRoaXMuX3RpbWVycyA9IHRoaXMuX3RpbWVycy5maWx0ZXIodCA9PiB0ICE9IHRpbWVyKTtcbiAgICAgICAgICAgIHdpbmRvdy5jbGVhckludGVydmFsKHRpbWVyKTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5pbnN0cnVjdGlvbnNUb1NlcmlhbGl6YWJsZUluc3RydWN0aW9ucyA9IChpbnN0cnVjdGlvbnMpID0+IGluc3RydWN0aW9ucy5tYXAoaSA9PiB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICdwcm9ncmFtSWQnOiBpLnByb2dyYW1JZC50b0Jhc2U1OCgpLFxuICAgICAgICAgICAgICAgICdhY2NvdW50TWV0YXMnOiBpLmtleXMubWFwKGsgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWRkcmVzczogay5wdWJrZXkudG9CYXNlNTgoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNpZ25lcjogay5pc1NpZ25lcixcbiAgICAgICAgICAgICAgICAgICAgICAgIHdyaXRhYmxlOiBrLmlzV3JpdGFibGUsXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgJ2RhdGEnOiB3aW5kb3cuYnRvYShTdHJpbmcuZnJvbUNoYXJDb2RlKC4uLmkuZGF0YSkpLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuaGFuZGxlV2FsbGV0TWVzc2FnZSA9IChkYXRhKSA9PiB7XG4gICAgICAgICAgICB2YXIgX2EsIF9iLCBfYztcbiAgICAgICAgICAgIGlmIChkYXRhLnR5cGUgPT0gXCJjb25uZWN0ZWRcIikge1xuICAgICAgICAgICAgICAgIHRoaXMuX2Nvbm5lY3RpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBpZiAoIWRhdGEuZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pc0xvZ2dlZEluID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKChfYSA9IGRhdGEuY29ubmVjdGVkKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EucHVibGljS2V5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9wdWJsaWNLZXkgPSBuZXcgUHVibGljS2V5KGRhdGEuY29ubmVjdGVkLnB1YmxpY0tleSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChbXCJzZW5kVHJhbnNhY3Rpb25cIiwgXCJzZW5kRmluYWxUcmFuc2FjdGlvblwiXS5pbmNsdWRlcyhkYXRhLnR5cGUpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdHJhbnNhY3Rpb25JZGVudGlmaWVyID0gKF9iID0gZGF0YS5zZW5kVHJhbnNhY3Rpb24pID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5pZGVudGlmaWVyO1xuICAgICAgICAgICAgICAgIGlmICh0cmFuc2FjdGlvbklkZW50aWZpZXIgJiYgdHJhbnNhY3Rpb25JZGVudGlmaWVyIGluIHRoaXMuX3BlbmRpbmdUcmFuc2FjdGlvbnMpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3BlbmRpbmdUcmFuc2FjdGlvbkVycm9yc1t0cmFuc2FjdGlvbklkZW50aWZpZXJdID0geyBtZXNzYWdlOiBkYXRhLmVycm9yIH07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9wZW5kaW5nVHJhbnNhY3Rpb25zW3RyYW5zYWN0aW9uSWRlbnRpZmllcl0gPSBkYXRhLnNlbmRUcmFuc2FjdGlvbiB8fCBudWxsO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoZGF0YS50eXBlID09IFwic2lnblRyYW5zYWN0aW9uXCIpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB0cmFuc2FjdGlvbklkZW50aWZpZXIgPSAoX2MgPSBkYXRhLnNpZ25UcmFuc2FjdGlvbikgPT09IG51bGwgfHwgX2MgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9jLmlkZW50aWZpZXI7XG4gICAgICAgICAgICAgICAgaWYgKHRyYW5zYWN0aW9uSWRlbnRpZmllciAmJiB0cmFuc2FjdGlvbklkZW50aWZpZXIgaW4gdGhpcy5fcGVuZGluZ1RyYW5zYWN0aW9ucykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5lcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcGVuZGluZ1RyYW5zYWN0aW9uRXJyb3JzW3RyYW5zYWN0aW9uSWRlbnRpZmllcl0gPSB7IG1lc3NhZ2U6IGRhdGEuZXJyb3IgfTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3BlbmRpbmdUcmFuc2FjdGlvbnNbdHJhbnNhY3Rpb25JZGVudGlmaWVyXSA9IGRhdGEuc2lnblRyYW5zYWN0aW9uIHx8IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuaXNMb2dnZWRJbiA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9wZW5kaW5nVHJhbnNhY3Rpb25zID0ge307XG4gICAgICAgIHRoaXMuX3BlbmRpbmdUcmFuc2FjdGlvbkVycm9ycyA9IHt9O1xuICAgICAgICB0aGlzLl90aW1lcnMgPSBbXTtcbiAgICAgICAgdGhpcy5fd2FsbGV0ID0gbnVsbDtcbiAgICAgICAgdGhpcy5fY29ubmVjdGluZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9wdWJsaWNLZXkgPSBudWxsO1xuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcIm1lc3NhZ2VcIiwgKGUpID0+IHtcbiAgICAgICAgICAgIHRoaXMuaGFuZGxlV2FsbGV0TWVzc2FnZShlLmRhdGEpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgYXN5bmMgY29ubmVjdCh1cmwpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHRoaXMudXJsID0gdXJsIHx8IHRoaXMudXJsO1xuICAgICAgICAgICAgY29uc3Qgb3JpZ2luID0gZW5jb2RlVVJJQ29tcG9uZW50KHdpbmRvdy5sb2NhdGlvbi5vcmlnaW4pO1xuICAgICAgICAgICAgY29uc3QgY29ubmVjdFVybCA9IGAke3RoaXMudXJsfS9jb25uZWN0P29yaWdpbj0ke29yaWdpbn1gO1xuICAgICAgICAgICAgdGhpcy5fY29ubmVjdGluZyA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLl93YWxsZXQgPSB3aW5kb3cub3Blbihjb25uZWN0VXJsLCBgY2Vuc28tY3VzdG9keS0ke29yaWdpbn1gLCBcImhlaWdodD05MDAsd2lkdGg9ODAwLG1lbnViYXI9bm8sc3RhdHVzPW5vLHRvb2xiYXI9bm9cIik7XG4gICAgICAgICAgICBpZiAoIXRoaXMuX3dhbGxldCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2Nvbm5lY3RpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJVbmFibGUgdG8gY29ubmVjdCB0byB3YWxsZXRcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl90aW1lcnMucHVzaCh3aW5kb3cuc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl93YWxsZXQuY2xvc2VkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2xlYW5VcCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmICh0aGlzLl93YWxsZXQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fd2FsbGV0LnBvc3RNZXNzYWdlKHsgdHlwZTogJ2hlYXJ0YmVhdCcgfSwgdGhpcy51cmwpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIDEwMCkpO1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCB0aW1lciA9IHdpbmRvdy5zZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzTG9nZ2VkSW4gJiYgdGhpcy5fcHVibGljS2V5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNsZWFyVGltZXIodGltZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh0aGlzLl9wdWJsaWNLZXkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKCF0aGlzLmlzTG9nZ2VkSW4gJiYgIXRoaXMuX2Nvbm5lY3RpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2xlYXJUaW1lcih0aW1lcik7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QobmV3IEVycm9yKFwiVW5hYmxlIHRvIGNvbm5lY3QgdG8gQ2Vuc29cIikpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSwgMTAwKTtcbiAgICAgICAgICAgICAgICB0aGlzLl90aW1lcnMucHVzaCh0aW1lcik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICB9XG4gICAgfVxuICAgIGFzeW5jIHNpZ25UcmFuc2FjdGlvbih0cmFuc2FjdGlvbikge1xuICAgICAgICB0aGlzLnZlcmlmeUNhblNpZ25SZXF1ZXN0cyhbdHJhbnNhY3Rpb25dKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNpZ25PbmVUcmFuc2FjdGlvbih0cmFuc2FjdGlvbik7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgfVxuICAgIH1cbiAgICBhc3luYyBzaWduQWxsVHJhbnNhY3Rpb25zKHRyYW5zYWN0aW9ucykge1xuICAgICAgICB0aGlzLnZlcmlmeUNhblNpZ25SZXF1ZXN0cyh0cmFuc2FjdGlvbnMpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2lnbk11bHRpcGxlVHJhbnNhY3Rpb25zKHRyYW5zYWN0aW9ucyk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgfVxuICAgIH1cbiAgICBhc3luYyBzZW5kVHJhbnNhY3Rpb24odHJhbnNhY3Rpb24sIGNvbm5lY3Rpb24sIG9wdGlvbnMpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHdhbGxldCA9IHRoaXMuX3dhbGxldDtcbiAgICAgICAgICAgIGlmICghd2FsbGV0KVxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIk5vdCBDb25uZWN0ZWRcIik7XG4gICAgICAgICAgICBjb25zdCB0cmFuc2FjdGlvbklkZW50aWZpZXIgPSB1dWlkdjQoKTtcbiAgICAgICAgICAgIHRoaXMuX3BlbmRpbmdUcmFuc2FjdGlvbnNbdHJhbnNhY3Rpb25JZGVudGlmaWVyXSA9IG51bGw7XG4gICAgICAgICAgICBjb25zdCBzaWduZXJzID0gb3B0aW9ucyA/IG9wdGlvbnMuc2lnbmVycyA6IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIGlmIChzaWduZXJzICYmIHNpZ25lcnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2lnbk9uZVRyYW5zYWN0aW9uKHRyYW5zYWN0aW9uLCB0cmFuc2FjdGlvbklkZW50aWZpZXIpLnRoZW4od2FsbGV0VHJhbnNhY3Rpb24gPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcGVuZGluZ1RyYW5zYWN0aW9uc1t0cmFuc2FjdGlvbklkZW50aWZpZXJdID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgIChzaWduZXJzID09PSBudWxsIHx8IHNpZ25lcnMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHNpZ25lcnMubGVuZ3RoKSAmJiB3YWxsZXRUcmFuc2FjdGlvbi5wYXJ0aWFsU2lnbiguLi5zaWduZXJzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdhbGxldC5wb3N0TWVzc2FnZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzZW5kRmluYWxUcmFuc2FjdGlvblwiLCBzZW5kRmluYWxUcmFuc2FjdGlvbjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvbklkZW50aWZpZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpZ25hdHVyZVB1YmtleVBhaXJzOiB3YWxsZXRUcmFuc2FjdGlvbi5zaWduYXR1cmVzLmZpbHRlcihzcCA9PiBzcC5zaWduYXR1cmUgIT0gbnVsbCkubWFwKHNwID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3B1YmtleSc6IHNwLnB1YmxpY0tleS50b0Jhc2U1OCgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdzaWduYXR1cmUnOiBzcC5zaWduYXR1cmUudG9TdHJpbmcoJ2Jhc2U2NCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIHRoaXMudXJsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHRpbWVyID0gd2luZG93LnNldEludGVydmFsKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwZW5kaW5nVHJhbnNhY3Rpb24gPSB0aGlzLl9wZW5kaW5nVHJhbnNhY3Rpb25zW3RyYW5zYWN0aW9uSWRlbnRpZmllcl07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcGVuZGluZ1RyYW5zYWN0aW9uRXJyb3IgPSB0aGlzLl9wZW5kaW5nVHJhbnNhY3Rpb25FcnJvcnNbdHJhbnNhY3Rpb25JZGVudGlmaWVyXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocGVuZGluZ1RyYW5zYWN0aW9uICE9IG51bGwgfHwgcGVuZGluZ1RyYW5zYWN0aW9uRXJyb3IgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNsZWFyVGltZXIodGltZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZW5kaW5nVHJhbnNhY3Rpb24gJiYgcmVzb2x2ZShwZW5kaW5nVHJhbnNhY3Rpb24uc2lnbmF0dXJlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVuZGluZ1RyYW5zYWN0aW9uRXJyb3IgJiYgcmVqZWN0KHBlbmRpbmdUcmFuc2FjdGlvbkVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9LCAxMDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGltZXJzLnB1c2godGltZXIpO1xuICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zdCBpbnN0cnVjdGlvbnMgPSB0aGlzLmluc3RydWN0aW9uc1RvU2VyaWFsaXphYmxlSW5zdHJ1Y3Rpb25zKHRyYW5zYWN0aW9uLmluc3RydWN0aW9ucyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgd2FsbGV0LnBvc3RNZXNzYWdlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic2VuZFRyYW5zYWN0aW9uXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBzZW5kVHJhbnNhY3Rpb246IHsgaW5zdHJ1Y3Rpb25zLCB0cmFuc2FjdGlvbklkZW50aWZpZXIgfVxuICAgICAgICAgICAgICAgICAgICB9LCB0aGlzLnVybCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHRpbWVyID0gd2luZG93LnNldEludGVydmFsKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHBlbmRpbmdUcmFuc2FjdGlvbiA9IHRoaXMuX3BlbmRpbmdUcmFuc2FjdGlvbnNbdHJhbnNhY3Rpb25JZGVudGlmaWVyXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHBlbmRpbmdUcmFuc2FjdGlvbkVycm9yID0gdGhpcy5fcGVuZGluZ1RyYW5zYWN0aW9uRXJyb3JzW3RyYW5zYWN0aW9uSWRlbnRpZmllcl07XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocGVuZGluZ1RyYW5zYWN0aW9uICE9IG51bGwgfHwgcGVuZGluZ1RyYW5zYWN0aW9uRXJyb3IgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2xlYXJUaW1lcih0aW1lcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVuZGluZ1RyYW5zYWN0aW9uICYmIHJlc29sdmUocGVuZGluZ1RyYW5zYWN0aW9uLnNpZ25hdHVyZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVuZGluZ1RyYW5zYWN0aW9uRXJyb3IgJiYgcmVqZWN0KHBlbmRpbmdUcmFuc2FjdGlvbkVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSwgMTAwKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGltZXJzLnB1c2godGltZXIpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgIH1cbiAgICB9XG4gICAgYnVpbGRUcmFuc2FjdGlvbihwZW5kaW5nVHJhbnNhY3Rpb24pIHtcbiAgICAgICAgbGV0IG1lc3NhZ2UgPSBNZXNzYWdlLmZyb20oQnVmZmVyLmZyb20oVWludDhBcnJheS5mcm9tKHdpbmRvdy5hdG9iKHBlbmRpbmdUcmFuc2FjdGlvbi5tZXNzYWdlKSwgYyA9PiBjLmNoYXJDb2RlQXQoMCkpKSk7XG4gICAgICAgIHJldHVybiBUcmFuc2FjdGlvbi5wb3B1bGF0ZShtZXNzYWdlLCBBcnJheS5mcm9tKHsgbGVuZ3RoOiBtZXNzYWdlLmhlYWRlci5udW1SZXF1aXJlZFNpZ25hdHVyZXMgfSwgKF92LCBpKSA9PiB7XG4gICAgICAgICAgICBsZXQgc2lnUHVia2V5UGFpciA9IHBlbmRpbmdUcmFuc2FjdGlvbi5zaWduYXR1cmVzLmZpbmQocyA9PiBzLnB1YmtleSA9PSBtZXNzYWdlLmFjY291bnRLZXlzW2ldLnRvQmFzZTU4KCkpO1xuICAgICAgICAgICAgcmV0dXJuIGJzNTguZW5jb2RlKHNpZ1B1YmtleVBhaXJcbiAgICAgICAgICAgICAgICA/IEJ1ZmZlci5mcm9tKFVpbnQ4QXJyYXkuZnJvbSh3aW5kb3cuYXRvYihzaWdQdWJrZXlQYWlyLnNpZ25hdHVyZSksIGMgPT4gYy5jaGFyQ29kZUF0KDApKSlcbiAgICAgICAgICAgICAgICA6IERFRkFVTFRfU0lHTkFUVVJFX0JVRkZFUik7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdmVyaWZ5Q2FuU2lnblJlcXVlc3RzKHRyYW5zYWN0aW9ucykge1xuICAgICAgICB0cmFuc2FjdGlvbnMuZm9yRWFjaCh0cmFuc2FjdGlvbiA9PiB7XG4gICAgICAgICAgICBpZiAodHJhbnNhY3Rpb24uc2lnbmF0dXJlcy5zb21lKHMgPT4gcy5zaWduYXR1cmUgIT0gbnVsbCkpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDZW5zbyBkb2VzIG5vdCBzdXBwb3J0IHRoaXMgc2lnbmluZyBtb2RlXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgc2lnbk9uZVRyYW5zYWN0aW9uKHRyYW5zYWN0aW9uLCB0cmFuc2FjdGlvbklkZW50aWZpZXIgPSB1dWlkdjQoKSkge1xuICAgICAgICBjb25zdCB3YWxsZXQgPSB0aGlzLl93YWxsZXQ7XG4gICAgICAgIGlmICghd2FsbGV0KVxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTm90IENvbm5lY3RlZFwiKTtcbiAgICAgICAgY29uc3QgaW5zdHJ1Y3Rpb25zID0gdGhpcy5pbnN0cnVjdGlvbnNUb1NlcmlhbGl6YWJsZUluc3RydWN0aW9ucyh0cmFuc2FjdGlvbi5pbnN0cnVjdGlvbnMpO1xuICAgICAgICB0aGlzLl9wZW5kaW5nVHJhbnNhY3Rpb25zW3RyYW5zYWN0aW9uSWRlbnRpZmllcl0gPSBudWxsO1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgd2FsbGV0LnBvc3RNZXNzYWdlKHsgdHlwZTogXCJzaWduVHJhbnNhY3Rpb25cIiwgc2lnblRyYW5zYWN0aW9uOiB7IGluc3RydWN0aW9ucywgdHJhbnNhY3Rpb25JZGVudGlmaWVyIH0gfSwgdGhpcy51cmwpO1xuICAgICAgICAgICAgY29uc3QgdGltZXIgPSB3aW5kb3cuc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHBlbmRpbmdUcmFuc2FjdGlvbiA9IHRoaXMuX3BlbmRpbmdUcmFuc2FjdGlvbnNbdHJhbnNhY3Rpb25JZGVudGlmaWVyXTtcbiAgICAgICAgICAgICAgICBjb25zdCBwZW5kaW5nVHJhbnNhY3Rpb25FcnJvciA9IHRoaXMuX3BlbmRpbmdUcmFuc2FjdGlvbkVycm9yc1t0cmFuc2FjdGlvbklkZW50aWZpZXJdO1xuICAgICAgICAgICAgICAgIGlmIChwZW5kaW5nVHJhbnNhY3Rpb24gIT0gbnVsbCB8fCBwZW5kaW5nVHJhbnNhY3Rpb25FcnJvciAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2xlYXJUaW1lcih0aW1lcik7XG4gICAgICAgICAgICAgICAgICAgIHBlbmRpbmdUcmFuc2FjdGlvbiAmJiByZXNvbHZlKHRoaXMuYnVpbGRUcmFuc2FjdGlvbihwZW5kaW5nVHJhbnNhY3Rpb24pKTtcbiAgICAgICAgICAgICAgICAgICAgcGVuZGluZ1RyYW5zYWN0aW9uRXJyb3IgJiYgcmVqZWN0KHBlbmRpbmdUcmFuc2FjdGlvbkVycm9yKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCAxMDApO1xuICAgICAgICAgICAgdGhpcy5fdGltZXJzLnB1c2godGltZXIpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgc2lnbk11bHRpcGxlVHJhbnNhY3Rpb25zKHRyYW5zYWN0aW9ucykge1xuICAgICAgICBjb25zdCB3YWxsZXQgPSB0aGlzLl93YWxsZXQ7XG4gICAgICAgIGlmICghd2FsbGV0KVxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTm90IENvbm5lY3RlZFwiKTtcbiAgICAgICAgY29uc3Qgc2VyaWFsaXplZFRyYW5zYWN0aW9ucyA9IHRyYW5zYWN0aW9ucy5tYXAoKHQpID0+IHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgaW5zdHJ1Y3Rpb25zOiB0aGlzLmluc3RydWN0aW9uc1RvU2VyaWFsaXphYmxlSW5zdHJ1Y3Rpb25zKHQuaW5zdHJ1Y3Rpb25zKSxcbiAgICAgICAgICAgICAgICB0cmFuc2FjdGlvbklkZW50aWZpZXI6IHV1aWR2NCgpXG4gICAgICAgICAgICB9O1xuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgdHJhbnNhY3Rpb25JZGVudGlmaWVycyA9IHNlcmlhbGl6ZWRUcmFuc2FjdGlvbnMubWFwKCh0KSA9PiB0LnRyYW5zYWN0aW9uSWRlbnRpZmllcik7XG4gICAgICAgIHRyYW5zYWN0aW9uSWRlbnRpZmllcnMuZm9yRWFjaCgodHJhbnNhY3Rpb25JZGVudGlmaWVyKSA9PiB0aGlzLl9wZW5kaW5nVHJhbnNhY3Rpb25zW3RyYW5zYWN0aW9uSWRlbnRpZmllcl0gPSBudWxsKTtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgIHdhbGxldC5wb3N0TWVzc2FnZSh7IHR5cGU6IFwic2lnbkFsbFRyYW5zYWN0aW9uc1wiLCBzaWduQWxsVHJhbnNhY3Rpb25zOiB7IHRyYW5zYWN0aW9uczogc2VyaWFsaXplZFRyYW5zYWN0aW9ucyB9IH0sIHRoaXMudXJsKTtcbiAgICAgICAgICAgIGNvbnN0IHRpbWVyID0gd2luZG93LnNldEludGVydmFsKCgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBwZW5kaW5nVHJhbnNhY3Rpb25zID0gdHJhbnNhY3Rpb25JZGVudGlmaWVycy5tYXAoKHR4SWQpID0+IHRoaXMuX3BlbmRpbmdUcmFuc2FjdGlvbnNbdHhJZF0pO1xuICAgICAgICAgICAgICAgIGNvbnN0IHBlbmRpbmdUcmFuc2FjdGlvbkVycm9ycyA9IHRyYW5zYWN0aW9uSWRlbnRpZmllcnMubWFwKCh0eElkKSA9PiB0aGlzLl9wZW5kaW5nVHJhbnNhY3Rpb25FcnJvcnNbdHhJZF0pO1xuICAgICAgICAgICAgICAgIGlmIChwZW5kaW5nVHJhbnNhY3Rpb25zLmV2ZXJ5KCh0KSA9PiB0ICE9IG51bGwpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2xlYXJUaW1lcih0aW1lcik7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUocGVuZGluZ1RyYW5zYWN0aW9ucy5tYXAoKHB0KSA9PiB0aGlzLmJ1aWxkVHJhbnNhY3Rpb24ocHQpKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHBlbmRpbmdUcmFuc2FjdGlvbkVycm9ycy5zb21lKChlKSA9PiBlICE9IG51bGwpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2xlYXJUaW1lcih0aW1lcik7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChwZW5kaW5nVHJhbnNhY3Rpb25FcnJvcnMuZmluZCgoZSkgPT4gZSAhPSBudWxsKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwgMTAwKTtcbiAgICAgICAgICAgIHRoaXMuX3RpbWVycy5wdXNoKHRpbWVyKTtcbiAgICAgICAgfSk7XG4gICAgfVxufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Y2Vuc29jdXN0b2R5LmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///../node_modules/.pnpm/@censo-custody+solana-wallet-adapter@0.1.0_bufferutil@4.0.9_encoding@0.1.13_utf-8-validate@5.0.10/node_modules/@censo-custody/solana-wallet-adapter/lib/esm/censocustody.js\n"));

/***/ }),

/***/ "../node_modules/.pnpm/@censo-custody+solana-wallet-adapter@0.1.0_bufferutil@4.0.9_encoding@0.1.13_utf-8-validate@5.0.10/node_modules/@censo-custody/solana-wallet-adapter/lib/esm/index.js":
/*!**************************************************************************************************************************************************************************************************!*\
  !*** ../node_modules/.pnpm/@censo-custody+solana-wallet-adapter@0.1.0_bufferutil@4.0.9_encoding@0.1.13_utf-8-validate@5.0.10/node_modules/@censo-custody/solana-wallet-adapter/lib/esm/index.js ***!
  \**************************************************************************************************************************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _censocustody_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./censocustody.js */ \"../node_modules/.pnpm/@censo-custody+solana-wallet-adapter@0.1.0_bufferutil@4.0.9_encoding@0.1.13_utf-8-validate@5.0.10/node_modules/@censo-custody/solana-wallet-adapter/lib/esm/censocustody.js\");\n/* harmony reexport (unknown) */ var __WEBPACK_REEXPORT_OBJECT__ = {};\n/* harmony reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in _censocustody_js__WEBPACK_IMPORTED_MODULE_0__) if(__WEBPACK_IMPORT_KEY__ !== \"default\") __WEBPACK_REEXPORT_OBJECT__[__WEBPACK_IMPORT_KEY__] = function(key) { return _censocustody_js__WEBPACK_IMPORTED_MODULE_0__[key]; }.bind(0, __WEBPACK_IMPORT_KEY__)\n/* harmony reexport (unknown) */ __webpack_require__.d(__webpack_exports__, __WEBPACK_REEXPORT_OBJECT__);\n\n//# sourceMappingURL=index.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi4vbm9kZV9tb2R1bGVzLy5wbnBtL0BjZW5zby1jdXN0b2R5K3NvbGFuYS13YWxsZXQtYWRhcHRlckAwLjEuMF9idWZmZXJ1dGlsQDQuMC45X2VuY29kaW5nQDAuMS4xM191dGYtOC12YWxpZGF0ZUA1LjAuMTAvbm9kZV9tb2R1bGVzL0BjZW5zby1jdXN0b2R5L3NvbGFuYS13YWxsZXQtYWRhcHRlci9saWIvZXNtL2luZGV4LmpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQWtDO0FBQ2xDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uLi9ub2RlX21vZHVsZXMvLnBucG0vQGNlbnNvLWN1c3RvZHkrc29sYW5hLXdhbGxldC1hZGFwdGVyQDAuMS4wX2J1ZmZlcnV0aWxANC4wLjlfZW5jb2RpbmdAMC4xLjEzX3V0Zi04LXZhbGlkYXRlQDUuMC4xMC9ub2RlX21vZHVsZXMvQGNlbnNvLWN1c3RvZHkvc29sYW5hLXdhbGxldC1hZGFwdGVyL2xpYi9lc20vaW5kZXguanM/ZTFjZSJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgKiBmcm9tICcuL2NlbnNvY3VzdG9keS5qcyc7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///../node_modules/.pnpm/@censo-custody+solana-wallet-adapter@0.1.0_bufferutil@4.0.9_encoding@0.1.13_utf-8-validate@5.0.10/node_modules/@censo-custody/solana-wallet-adapter/lib/esm/index.js\n"));

/***/ })

}]);